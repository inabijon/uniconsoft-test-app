<div class="h-screen relative overflow-hidden">
  <!-- Background Pattern -->
  <div
    class="absolute inset-0 {{ layoutService.backgroundImageWithClass() }}"
  ></div>

  <!-- HEADER -->
  <app-header />

  <div class="flex h-[calc(100vh-80px)]">
    <!-- Desktop Sidebar -->
    <div
      class="hidden lg:block flex-shrink-0 overflow-y-auto transition-all duration-300"
      [class.w-64]="
        (!layoutService.isOverlay() &&
          !layoutService.layoutState().staticMenuDesktopInactive) ||
        layoutService.isDesktopSidebarFull()
      "
      [class.w-16]="layoutService.isDesktopSidebarCompact()"
      [class.w-0]="
        layoutService.isDesktopSidebarHidden() ||
        (!layoutService.isOverlay() &&
          layoutService.layoutState().staticMenuDesktopInactive)
      "
      [class.opacity-100]="
        !layoutService.isDesktopSidebarHidden() &&
        !(
          !layoutService.isOverlay() &&
          layoutService.layoutState().staticMenuDesktopInactive
        )
      "
      [class.opacity-0]="
        layoutService.isDesktopSidebarHidden() ||
        (!layoutService.isOverlay() &&
          layoutService.layoutState().staticMenuDesktopInactive)
      "
    >
      <app-sidebar
        [isDesktop]="true"
        [isCompact]="layoutService.isDesktopSidebarCompact() ? true : false"
      />
    </div>

    <!-- Mobile/Tablet Sidebar (Overlay) -->
    <div class="lg:hidden">
      <app-sidebar [isDesktop]="false" />
    </div>

    <!-- Main Content Area -->
    <main class="flex-1 flex">
      <!-- Router Outlet -->
      <div class="flex-1 overflow-y-auto p-6">
        <router-outlet></router-outlet>
      </div>

      <!-- Right Sidebar -->
      @if (widgetService.getRightSidebarVisibility()) {
        <aside
          class="w-80 h-full max-h-[calc(100vh-80px)] pb-5 bg-white/10 backdrop-blur-md border-l border-white/20 overflow-y-auto"
        >
          <app-widgets  />
        </aside>
      }

      <!-- Right Sidebar Settings - Always visible but can be toggled via settings -->
      <section class="w-14 h-full max-h-[calc(100vh-80px)] pb-5 bg-white/10 backdrop-blur-md border-l border-white/20 overflow-y-auto">
        <app-right-sidebar-settings />
      </section>
    </main>

  </div>

</div>
